/**********************************
 * File: pindefs.c
 * InVue Security Products
 * Copyright 2022
 **********************************/
#include <stdbool.h>
#include "periphdefs.h"
// BSP
#include "stm32g0xx.h"
//#include "live_defaults.h"
#include "periphdefs.h"



/************ TIMERS ************/

const uint32_t _blockingTimerclkFreq;

const uint32_t  _blockingTimerOutClkFreq;
// MUST maintain same order as enum timer_id.
/*
 * TIMER_PIEZO_PWM,
    TIMER_WPT_PWM,
	TIMER_VBOOST_CAL_PWM,
    TIMER_BLOCKING_DELAY,
	TIMER_COMMUNICATE_SHUTDOWN,
 */
timer_config_t const timer_defs[NUMBER_OF_TIMERS] =
{
		    //  timer,  	      type, 	  channel,    prescale_powers_of_2	timer_irq_cb
			{   TIM1,       TIM_GEN_PURPOSE, TIMER_CH1,   0,                   (void*)0}, // TIMER_PIEZO_PWM
			{   TIM3,       TIM_GEN_PURPOSE, TIMER_CH1,   0,                   (void*)0}, // TIMER_WPT_PWM
			{   TIM15,      TIM_GEN_PURPOSE, TIMER_CH1,   0,                   (void*)0}, // TIMER_VBOOST_CAL_PWM,
			{   TIM6,       TIM_BASIC,       TIMER_CH0,   0,                   (void*)0}, // TIMER_BLOCKING_DELAY,
			{   TIM14,      TIM_GEN_PURPOSE, TIMER_CH1,   0,                   (void*)0}  // TIMER_COMMUNICATE_SHUTDOWN
};

irq_config_t irq_priorities[NUM_PRIORITIZED_IRQS] =
{
		// irq_num			nvic_priority_t
		{USART1_IRQn,	 	NVIC_PRIORITY_MID_HIGH},       // IRDot / Daisy_Chain
		{USART2_IRQn, 		NVIC_PRIORITY_HIGH},   		   // USART_Power
		{USART3_4_IRQn, 	NVIC_PRIORITY_MID_LOW},        // LORA_Dongle
};

uart_config_t const uart_defs[NUMBER_OF_UARTS] =
{
	{
		{
		    USART1,
		    UART_TYPE_USART,
			TWO_WIRE,
			6553,
		    FREQ_SYSCLK,
		    (void*)0
	    }
	},

#ifdef UART2INDX
	{
		{
		    USART2,
		    UART_TYPE_USART,
			TWO_WIRE,
		    115200,
		    FREQ_SYSCLK,
		    (void*)0
		}
	},
#endif
#ifdef UART3INDX
	{
		{
		    USART2,
		    UART_TYPE_USART,
			TWO_WIRE,
		    115200,
		    FREQ_SYSCLK,
		    (void*)0
		}
	},
#endif
#ifdef UART4INDX
	{
		{
		    USART4,
		    UART_TYPE_USART,
			TWO_WIRE,
		    115200,
		    FREQ_SYSCLK,
		    (void*)0
		}
	},
#endif
};
